{% extends "base.html" %}
{% block title %}Challenges — Habit Competition{% endblock %}
{% block content %}
<div class="flex items-center justify-between mb-4">
    <h1 class="text-2xl font-semibold">Challenges</h1>
    <div class="flex gap-2">
        {% with s=selected_status %}
        <a href="?status=active"
            class="px-3 py-1 rounded border {% if s == 'active' %}bg-black text-white{% else %}bg-white{% endif %}">Active</a>
        <a href="?status=upcoming"
            class="px-3 py-1 rounded border {% if s == 'upcoming' %}bg-black text-white{% else %}bg-white{% endif %}">Upcoming</a>
        <a href="?status=past"
            class="px-3 py-1 rounded border {% if s == 'past' %}bg-black text-white{% else %}bg-white{% endif %}">Past</a>
        <a href="."
            class="px-3 py-1 rounded border {% if not s %}bg-black text-white{% else %}bg-white{% endif %}">All</a>
        {% endwith %}
    </div>

</div>

{% if challenges %}
<ul class="grid md:grid-cols-2 gap-4">
    {% for ch in challenges %}
    <li class="bg-white border rounded p-4">
        <div class="flex items-center justify-between mb-2">
            <a href="{{ ch.get_absolute_url }}" class="text-lg font-semibold hover:underline">{{ ch.name }}</a>
            <span class="text-xs px-2 py-1 rounded border">
                {{ ch.status|title }}
            </span>
        </div>
        <p class="text-sm text-gray-600 mb-3">
            {{ ch.start_date }} → {{ ch.end_date }}
        </p>
        <p class="text-sm line-clamp-3">{{ ch.description|default:"No description yet." }}</p>
        <div class="mt-3">
            <a href="{{ ch.get_absolute_url }}" class="text-sm underline">Open</a>
        </div>
    </li>
    {% endfor %}
</ul>

{% if is_paginated %}
<div class="mt-6 flex items-center gap-2">
    {% if page_obj.has_previous %}
    <a class="px-3 py-1 border rounded"
        href="?{% if selected_status %}status={{ selected_status }}&{% endif %}page={{ page_obj.previous_page_number }}">Prev</a>
    {% endif %}
    <span class="text-sm">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
    <a class="px-3 py-1 border rounded"
        href="?{% if selected_status %}status={{ selected_status }}&{% endif %}page={{ page_obj.next_page_number }}">Next</a>
    {% endif %}
</div>
{% endif %}
{% else %}
<p>No challenges found.</p>
{% endif %}
{% endblock %}
